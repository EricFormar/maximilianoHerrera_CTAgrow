<!DOCTYPE html>
<html lang="en">
    <%- include('../partials/head') %>

    <body>
        <%- include('../partials/header') %>
        <main class="shopcar">
            <h1>Mi carrito</h1>

            <% if (cart.length === 0) { %>
            <p>Tu carrito está vacío.</p>
            <% } else { %>
            <table>
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Precio</th>
                        <th>Cantidad</th>
                        <th>Subtotal</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <% cart.forEach(item => { %>
                    <tr>
                        <td>
                            <img
                                src="/images/products/<%= item.product.image %>"
                                alt="<%= item.product.name %>"
                                width="50"
                            />
                            <%= item.product.name %>
                        </td>
                        <td>$<%= item.product.price %></td>
                        <td>
                            <form
                                id="formAdd"
                                method="POST"
                                action="/shopcar/update/<%= item.product.id %>"
                            >
                                <input
                                    type="number"
                                    name="quantity"
                                    value="<%= item.cant %>"
                                    min="1"
                                />
                                <button type="submit">Actualizar</button>
                            </form>
                        </td>
                        <td>$<%= item.product.price * item.cant %></td>
                        <td>
                            <form
                                method="POST"
                                action="/shopcar/remove/<%= item.product.id %>?_method=DELETE"
                            >
                                <button type="submit">Eliminar</button>
                            </form>
                        </td>
                    </tr>
                    <% }) %>
                </tbody>
            </table>

            <h3>Total: $</h3>

            <form method="POST" action="/shopcar/clear?_method=DELETE">
                <button type="submit">Vaciar carrito</button>
            </form>

            <a href="/checkout" class="btn">Finalizar compra</a>
            <% } %>
        </main>

        <%- include('../partials/footer') %>
    </body>
    <script src="/public/javascripts/home.js"></script>
</html>
